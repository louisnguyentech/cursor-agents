Fix the bug in the selected code.

RULES:
- Identify root cause
- Modify minimal code only
- Do NOT refactor unless required
- Keep public API unchanged
- Explain briefly AFTER fixing
